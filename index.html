<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ceník per v Evropě</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0b1020; --panel:#11172a; --panel-2:#0e1426; --text:#eaf0ff; --muted:#97a3c0;
      --primary:#6aa5ff; --primary-2:#3f7fff; --accent:#20d4d4; --border:#1d2746; --radius:14px;
      --card-shadow:0 6px 24px rgba(8,12,24,.35);
      --good:#2ecc71; --warn:#f39c12; --bad:#ff5c7c;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% -10%, #1a2550 0%, transparent 60%),
        radial-gradient(1000px 600px at 90% -20%, #192a4a 0%, transparent 65%),
        var(--bg);
    }
    .wrap{max-width:1100px;margin:32px auto;padding:0 16px}
    header{display:flex;gap:16px;align-items:center;justify-content:flex-start;margin-bottom:20px}
    .title{display:flex;align-items:center;gap:12px}
    .title h1{margin:0;font-weight:700;font-size:clamp(20px,3vw,28px)}

    .toolbar{
      display:grid;grid-template-columns:repeat(12,1fr);gap:12px;
      background:linear-gradient(180deg,var(--panel),var(--panel-2));
      border:1px solid var(--border);padding:14px;border-radius:var(--radius);box-shadow:var(--card-shadow)
    }
    .tool{grid-column: span 4; display:flex;flex-direction:column;gap:6px}
    .tool label{font-size:12px;color:var(--muted)}
    select,input{
      width:100%;height:40px;border-radius:10px;border:1px solid var(--border);
      background:#0c1327;color:var(--text);padding:0 12px;outline:none
    }
    select:focus,input:focus{box-shadow:0 0 0 4px rgba(32,212,212,.25)}

    .cards{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;margin:18px 0}
    .card{grid-column: span 3;background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid var(--border);border-radius:var(--radius);padding:16px;box-shadow:var(--card-shadow)}
    .kpi{font-size:28px;font-weight:800}
    .kpi-label{color:var(--muted);font-size:12px;margin-top:6px}

    .table-wrap{
      background:linear-gradient(180deg,var(--panel),var(--panel-2));
      border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--card-shadow);
      overflow-x:auto; /* klíč pro mobily: horizontální scroll */
      -webkit-overflow-scrolling: touch;
      margin-top:16px
    }
    table{width:100%;border-collapse:separate;border-spacing:0;table-layout:auto}
    thead th{
      position:sticky;top:0;background:#0e152d;border-bottom:1px solid var(--border);
      text-align:left;font-weight:700;padding:12px;font-size:13px;white-space:nowrap
    }
    tbody td{
      padding:12px;border-bottom:1px solid var(--border);font-size:14px;
      vertical-align:top;word-break:break-word
    }
    tbody tr:hover{background:#0f1936}

    /* identifikace sloupců kvůli responsivitě */
    .col-orig{}, .col-note{}

    .pill{display:inline-block;border-radius:999px;padding:4px 10px;font-size:12px;font-weight:700}
    .pill.excellent{background:rgba(46,204,113,.25);color:#c9ffdf;border:1px solid rgba(46,204,113,.35)}
    .pill.good{background:rgba(46,204,113,.15);color:#9dffcc}
    .pill.ok{background:rgba(241,196,15,.18);color:#ffeaa7}
    .pill.warn{background:rgba(243,156,18,.15);color:#ffd39a}
    .pill.bad{background:rgba(255,92,124,.15);color:#ffb3c1}

    .muted{color:var(--muted)}

    /* Responsivita */
    @media (max-width: 900px){
      .tool{grid-column: span 6}
      .card{grid-column: span 6}
    }
    @media (max-width: 640px){
      .tool{grid-column: span 12}
      .card{grid-column: span 12}
      .table-wrap{margin:10px -8px 0 -8px;border-radius:10px}
      thead th, tbody td{padding:10px;font-size:13px}
    }
    /* Na velmi úzkých displejích: skryj méně důležité sloupce pro přehlednost */
    @media (max-width: 480px){
      thead th.col-orig, thead th.col-note,
      tbody td.col-orig, tbody td.col-note{display:none}
      thead th, tbody td{padding:8px;font-size:12px}
      .kpi{font-size:22px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 20h12M8 16l8-8a2.828 2.828 0 114 4l-8 8H8v-4z" stroke="#6aa5ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <h1>Ceník per v Evropě</h1>
      </div>
    </header>

    <div class="toolbar">
      <div class="tool">
        <label>Země</label>
        <select id="countryFilter"><option value="all">Všechny</option></select>
      </div>
      <div class="tool">
        <label>Pero (síla)</label>
        <select id="harnessFilter"><option value="all">Vše</option></select>
      </div>
      <div class="tool">
        <label>Řazení</label>
        <select id="sortBy">
          <option value="default">Výchozí</option>
          <option value="price-asc">Nejlevnější / mg</option>
          <option value="price-desc">Nejdražší / mg</option>
          <option value="country">Země</option>
          <option value="dose">Účinná látka</option>
        </select>
      </div>
      <div class="tool">
        <label>Vyhledat</label>
        <input id="search" placeholder="Hledej zemi, sílu, poznámku…" />
      </div>
    </div>

    <div class="cards">
      <div class="card"><div class="kpi" id="kpiCountries">–</div><div class="kpi-label">Zemí v porovnání</div></div>
      <div class="card"><div class="kpi" id="kpiProducts">–</div><div class="kpi-label">Dostupných produktů</div></div>
      <div class="card"><div class="kpi" id="kpiBest">–</div><div class="kpi-label">Nejlepší cena / 1mg</div></div>
      <div class="card"><div class="kpi" id="kpiSaving">–</div><div class="kpi-label">Potenciální úspora</div></div>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Země</th>
            <th>Pero</th>
            <th>Účinná látka</th>
            <th class="col-orig">Cena orig.</th>
            <th>Cena CZK</th>
            <th>Cena / 1mg</th>
            <th>Cena / 1mg (zlatá)</th>
            <th class="col-note">Poznámka</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

    <p class="muted" style="margin-top:12px">
      Fixní kurzy pro přepočet: EUR 24.20 CZK, PLN 5.90 CZK.
      <br>
      <strong>Upozornění:</strong> uvedené přepočty a ceny jsou orientační a mohou se lišit podle konkrétního prodejce, lokální dostupnosti a aktuálního kurzu.
    </p>
  </div>

  <script>
    const CONFIG = {
      rates:{ EUR:24.2, PLN:5.90 },
      items:[
        { country:"Česko", harness:"2.5", substanceMgTotal:10, price:{amount:4790, currency:"CZK"}, note:"" },
        { country:"Česko", harness:"5", substanceMgTotal:20, price:{amount:6130, currency:"CZK"}, note:"" },
        { country:"Česko", harness:"5*5*5", substanceMgTotal:60, price:{amount:18390, currency:"CZK"}, note:"set 3 pera" },
        { country:"Česko", harness:"7.5", substanceMgTotal:30, price:{amount:8790, currency:"CZK"}, note:"" },
        { country:"Česko", harness:"10", substanceMgTotal:40, price:{amount:8790, currency:"CZK"}, note:"" },
        { country:"Česko", harness:"10*10*10", substanceMgTotal:120, price:{amount:25490, currency:"CZK"}, note:"set 3 pera" },
        { country:"Česko", harness:"12.5", substanceMgTotal:50, price:{amount:10990, currency:"CZK"}, note:"aktualizace 08-2025" },
        { country:"Česko", harness:"15", substanceMgTotal:60, price:{amount:10990, currency:"CZK"}, note:"aktualizace 08-2025" },

        { country:"Slovensko", harness:"2.5", substanceMgTotal:10, price:{amount:177, currency:"EUR"}, note:"" },
        { country:"Slovensko", harness:"5", substanceMgTotal:20, price:{amount:235, currency:"EUR"}, note:"" },
        { country:"Slovensko", harness:"5*5*5", substanceMgTotal:60, price:{amount:710, currency:"EUR"}, note:"set 3 pera" },
        { country:"Slovensko", harness:"7.5", substanceMgTotal:30, price:{amount:335, currency:"EUR"}, note:"" },
        { country:"Slovensko", harness:"10", substanceMgTotal:40, price:{amount:350, currency:"EUR"}, note:"" },
        { country:"Slovensko", harness:"10*10*10", substanceMgTotal:120, price:{amount:991, currency:"EUR"}, note:"set 3 pera" },
        { country:"Slovensko", harness:"12.5", substanceMgTotal:50, price:{amount:429, currency:"EUR"}, note:"nová cena 07/2025" },
        { country:"Slovensko", harness:"15", substanceMgTotal:60, price:{amount:429, currency:"EUR"}, note:"nová cena 07/2025" },

        { country:"Německo", harness:"2.5", substanceMgTotal:10, price:{amount:206, currency:"EUR"}, note:"" },
        { country:"Německo", harness:"5", substanceMgTotal:20, price:{amount:277, currency:"EUR"}, note:"" },
        { country:"Německo", harness:"7.5", substanceMgTotal:30, price:{amount:383, currency:"EUR"}, note:"" },
        { country:"Německo", harness:"10", substanceMgTotal:40, price:{amount:383, currency:"EUR"}, note:"" },
        { country:"Německo", harness:"12.5", substanceMgTotal:50, price:{amount:489, currency:"EUR"}, note:"" },
        { country:"Německo", harness:"15", substanceMgTotal:60, price:{amount:489, currency:"EUR"}, note:"" },
        { country:"Německo", harness:"15*15*15", substanceMgTotal:180, price:{amount:1445, currency:"EUR"}, note:"set 3 pera" },

        { country:"Polsko", harness:"2.5", substanceMgTotal:10, price:{amount:890, currency:"PLN"}, note:"" },
        { country:"Polsko", harness:"5", substanceMgTotal:20, price:{amount:1165, currency:"PLN"}, note:"" },
        { country:"Polsko", harness:"7.5", substanceMgTotal:30, price:{amount:1630, currency:"PLN"}, note:"" },
        { country:"Polsko", harness:"10", substanceMgTotal:40, price:{amount:null, currency:"PLN"}, note:"" },
        { country:"Polsko", harness:"12.5", substanceMgTotal:50, price:{amount:2097, currency:"PLN"}, note:"" },
        { country:"Polsko", harness:"15", substanceMgTotal:60, price:{amount:2097, currency:"PLN"}, note:"" },

        { country:"Rakousko", harness:"7.5", substanceMgTotal:30, price:{amount:466, currency:"EUR"}, note:"" },
        { country:"Rakousko", harness:"10", substanceMgTotal:40, price:{amount:466, currency:"EUR"}, note:"" },
        { country:"Rakousko", harness:"15", substanceMgTotal:60, price:{amount:581.4, currency:"EUR"}, note:"" }
      ]
    };

    const fmtCZK = n => (n==null||isNaN(n))? '–' : n.toLocaleString('cs-CZ',{style:'currency',currency:'CZK',maximumFractionDigits:0});
    const fmtPrice = p => p.amount==null? '–' : (p.currency==='CZK'? `${(+p.amount).toLocaleString('cs-CZ')} Kč` : `${(+p.amount).toLocaleString('cs-CZ')} ${p.currency}`);
    const toCZK = (item)=>{ const {amount,currency}=item.price; if(amount==null) return null; if(currency==='CZK') return Math.round(amount); const r=CONFIG.rates[currency]; return r? Math.round(amount*r):null; };
    const unit = (item)=>{ const czk=toCZK(item); return (!czk||!item.substanceMgTotal)? null : Math.round(czk/item.substanceMgTotal); };
    const unitGold = (item)=>{ const czk=toCZK(item); return (!czk||!item.substanceMgTotal)? null : Math.round(czk/Math.round(item.substanceMgTotal*1.5)); };

    function populateFilters(){
      const countries=[...new Set(CONFIG.items.map(i=>i.country))].sort();
      const harnesses=[...new Set(CONFIG.items.map(i=>i.harness))].sort((a,b)=>{const na=parseFloat(a), nb=parseFloat(b); return (isNaN(na)||isNaN(nb))? a.localeCompare(b): na-nb;});
      countryFilter.innerHTML = '<option value="all">Všechny</option>'+countries.map(c=>`<option>${c}</option>`).join('');
      harnessFilter.innerHTML = '<option value="all">Vše</option>'+harnesses.map(h=>`<option>${h}</option>`).join('');
    }

    function compute(){
      const q = (search.value||'').trim().toLowerCase();
      const c = countryFilter.value; const h = harnessFilter.value; const sort = sortBy.value;
      let rows = CONFIG.items.map(it=>({ ...it, czk: toCZK(it), unit: unit(it), unitGold: unitGold(it) }));
      if(c!=='all') rows = rows.filter(r=>r.country===c);
      if(h!=='all') rows = rows.filter(r=> (r.harness||'').split('*')[0]===h);
      if(q) rows = rows.filter(r=> `${r.country} ${r.harness} ${r.substanceMgTotal} ${r.note}`.toLowerCase().includes(q));
      if(sort==='price-asc') rows.sort((a,b)=> (a.unit??1e9)-(b.unit??1e9));
      else if(sort==='price-desc') rows.sort((a,b)=> (b.unit??-1)-(a.unit??-1));
      else if(sort==='country') rows.sort((a,b)=> a.country.localeCompare(b.country)||((a.unit??1e9)-(b.unit??1e9)));
      else if(sort==='dose') rows.sort((a,b)=> (a.substanceMgTotal??0)-(b.substanceMgTotal??0));
      return rows;
    }

    function renderKPIs(rows){
      const countries = new Set(rows.map(r=>r.country));
      const valids = rows.filter(r=>r.unit!=null).map(r=>r.unit);
      const min = valids.length? Math.min(...valids): null;
      const max = valids.length? Math.max(...valids): null;
      kpiCountries.textContent = countries.size; kpiProducts.textContent = rows.filter(r=>r.unit!=null).length;
      kpiBest.textContent = min!=null? `${min} Kč`:'–'; kpiSaving.textContent = (min!=null&&max!=null)? `${(max-min)} Kč`:'–';
    }

    function renderTable(rows){
      const tb = document.getElementById('tbody'); tb.innerHTML='';
      let cur=null; const min = rows.filter(r=>r.unit!=null).reduce((m,r)=>m==null? r.unit: Math.min(m,r.unit), null);
      const minG = rows.filter(r=>r.unitGold!=null).reduce((m,r)=>m==null? r.unitGold: Math.min(m,r.unitGold), null);
      for(const r of rows){
        if(r.country!==cur){
          cur=r.country;
          const trC=document.createElement('tr');
          const td=document.createElement('td'); td.colSpan=8; td.innerHTML=`<strong>${cur}</strong>`;
          trC.appendChild(td); tb.appendChild(trC);
        }
        const ratio = (r.unit==null||min==null)? 9 : r.unit/min;
        const ratioG = (r.unitGold==null||minG==null)? 9 : r.unitGold/minG;
        const kind = ratio<=1.05?'excellent': ratio<=1.15?'good': ratio<=1.35?'ok': ratio<=1.6?'warn':'bad';
        const kindG= ratioG<=1.05?'excellent': ratioG<=1.15?'good': ratioG<=1.35?'ok': ratioG<=1.6?'warn':'bad';
        const tr=document.createElement('tr');
        tr.innerHTML = `
          <td>${r.country}</td>
          <td>${r.harness}</td>
          <td>${r.substanceMgTotal} mg</td>
          <td class="col-orig">${fmtPrice(r.price)}</td>
          <td>${fmtCZK(r.czk)}</td>
          <td>${r.unit==null? '<span class="muted">–</span>' : `<span class="pill ${kind}">${r.unit} Kč</span>`}</td>
          <td>${r.unitGold==null? '<span class="muted">–</span>' : `<span class="pill ${kindG}">${r.unitGold} Kč</span>`}</td>
          <td class="col-note muted">${r.note||'–'}</td>`;
        tb.appendChild(tr);
      }
    }

    function init(){
      populateFilters();
      const rows = compute(); renderKPIs(rows); renderTable(rows);
      document.getElementById('countryFilter').addEventListener('change', ()=>{ const r=compute(); renderKPIs(r); renderTable(r); });
      document.getElementById('harnessFilter').addEventListener('change', ()=>{ const r=compute(); renderKPIs(r); renderTable(r); });
      document.getElementById('sortBy').addEventListener('change', ()=>{ const r=compute(); renderKPIs(r); renderTable(r); });
      document.getElementById('search').addEventListener('input', ()=>{ const r=compute(); renderKPIs(r); renderTable(r); });
    }
    if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', init); else init();
  </script>
</body>
</html>
